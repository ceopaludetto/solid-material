---
import "@fontsource/poppins/300.css";
import "@fontsource/poppins/400.css";
import "@fontsource/poppins/500.css";

import { NavigationDrawer, NavigationDrawerItem } from "@solidjs-material/core";
import { BsToggleOff, BsCardText } from "solid-icons/bs";

import Footer from "~/components/footer.astro";
import Header from "~/components/header.astro";
import TOC from "~/components/toc.astro";

export interface Props {
  title: string;
}

const { frontmatter, headings } = Astro.props;

const sidebar = [
  ["Guide", await Astro.glob("../pages/guide/*.mdx")],
  ["Components", await Astro.glob("../pages/components/*.mdx")],
] as const;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{frontmatter.title} - Solid Material</title>
  </head>
  <body class="min-h-screen">
    <Header />
    <main class="grid grid-rows-[1fr] items-start max-lg:grid-cols-[1fr] lg:grid-cols-[300px,1fr,250px]">
      <aside class="sticky top-20 h-[calc(100vh-72px)] max-h-full overflow-y-auto max-lg:hidden">
        <NavigationDrawer client:load>
          {
            sidebar.map(([section, items]) => (
              <>
                <div class="mx-3 flex items-center gap-x-3 py-2">
                  {section === "Guide" && <BsCardText />}
                  {section === "Components" && <BsToggleOff />}
                  <span class="text-title-small capitalize text-on-surface-variant">{section}</span>
                </div>
                {items.map((item) => (
                  <NavigationDrawerItem
                    class="capitalize"
                    active={item.url === frontmatter.url}
                    client:load
                    as="a"
                    href={item.url}
                  >
                    {item.frontmatter.title}
                  </NavigationDrawerItem>
                ))}
              </>
            ))
          }
        </NavigationDrawer>
      </aside>
      <aside id="toc" class="mb-5 px-4 lg:hidden">
        <TOC headings={headings} />
      </aside>
      <div
        class="prose max-w-none px-4 prose-h1:text-headline-large prose-h1:text-on-surface prose-h2:text-headline-medium prose-h2:text-on-surface prose-h3:text-on-surface prose-p:text-body-large prose-p:text-on-surface prose-a:text-on-secondary-container prose-a:no-underline hover:prose-a:text-primary prose-code:text-on-secondary-container"
      >
        <slot />
        <Footer tight />
      </div>
      <aside id="toc" class="sticky top-20 max-h-full overflow-y-auto px-4 max-lg:hidden">
        <TOC headings={headings} />
      </aside>
    </main>
  </body>
</html>

<style is:global>
  @font-face {
    font-family: Poppins override;
    src: local("BlinkMacSystemFont"), local("Segoe UI"), local("Helvetica Neue"), local("Arial"), local("Noto Sans");
    ascent-override: 105%;
    descent-override: 35%;
    line-gap-override: 10%;
  }

  .astro-code {
    @apply max-lg:max-w-[calc(100vw-32px)] lg:max-w-[calc(100vw-300px-250px-32px)];
  }

  html {
    scroll-behavior: smooth;
  }
</style>
